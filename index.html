<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <title data-i18n="title">中共プロパガンダ・テキストジェネレーター</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Color+Emoji&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/i18next@23.7.6/dist/umd/i18next.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/i18next-browser-languagedetector@7.2.0/dist/umd/i18nextBrowserLanguageDetector.min.js"></script>
  <script src="app.js"></script>
</head>
<body>
<div class="app">
  <div id="settingsOverlay" class="settings-overlay"></div>
  <aside id="settingsPanel">
    <div class="settings-header">
      <h2 style="font-size:14px;margin:4px 0 10px;" data-i18n="settings">設定</h2>
      <div style="display: flex; align-items: center; gap: 8px;">
        <select id="languageSelect" style="font-size: 11px; padding: 4px 6px;">
          <option value="ja" selected>日本語</option>
          <option value="en">English</option>
          <option value="zh-Hant">繁體中文</option>
          <option value="zh-Hans">简体中文</option>
          <option value="ko">한국어</option>
        </select>
        <button id="settingsClose" class="settings-close-btn" aria-label="設定を閉じる">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- 背景画像選択 -->
    <div class="field">
      <label data-i18n="backgroundSelect">背景画像選択</label>
      <select id="bgSelect">
        <option value="background.png" data-i18n="backgroundForeignAffairs">外交部ver</option>
        <option value="background1.png" data-i18n="backgroundForeignAffairs2">外交部2ver</option>
        <option value="background1.1.png" data-i18n="backgroundForeignAffairs3">外交部3ver</option>
        <option value="background1.2.png" data-i18n="backgroundForeignAffairs4">外交部4ver</option>
        <option value="background2.png" data-i18n="backgroundDefense">国防部ver</option>
        <option value="background3.png" data-i18n="backgroundMaoNing">毛宁ver</option>
      </select>
      <div class="muted" data-i18n="backgroundSelectDesc">背景を切り替え</div>
    </div>

    <!-- 国旗選択（毛宁verのときのみ表示） -->
    <div class="field" id="flagSelectContainer" style="display: none;">
      <label data-i18n="flagSelect">ヘッダー国旗選択</label>
      <div class="inline">
        <div class="field">
          <label data-i18n="flag1">国旗1</label>
          <select id="flag1">
            <option value="" data-i18n="loading">読み込み中...</option>
          </select>
        </div>
        <div class="field">
          <label data-i18n="flag2">国旗2</label>
          <select id="flag2">
            <option value="" data-i18n="loading">読み込み中...</option>
          </select>
        </div>
      </div>
      <div class="muted" data-i18n="flagSelectDesc">毛宁verのときのみ表示</div>
    </div>
    
    <div class="field">
      <label data-i18n="mainText">メインテキスト</label>
      <textarea id="text" data-i18n="[placeholder]mainTextPlaceholder" placeholder="“日本は再び軍国主義の過ちを繰り返すつもりなのか…”"></textarea>
    </div>

    <!-- 選択部分を金色にするボタン -->
    <div class="field">
      <button class="btn" id="highlightGoldBtn" type="button" data-i18n="highlightGold">
        選択部分を金色にする
      </button>
      <div class="muted" data-i18n="highlightGoldDesc">
        テキスト内で範囲選択してから押すと、その部分だけ金色で描画されます。
      </div>
    </div>

    <div class="inline">
      <div class="field">
        <label data-i18n="fontSize">本文フォントサイズ(px)</label>
        <input id="fontSize" type="number" value="80" min="24" max="160" step="2">
      </div>
      <div class="field">
        <label data-i18n="lineHeight">行間(倍率)</label>
        <input id="lineHeight" type="number" value="1.25" step="0.05" min="1" max="2">
      </div>
    </div>

    <div class="inline">
      <div class="field">
        <label data-i18n="marginX">左右マージン(%)</label>
        <input id="marginX" type="number" value="12" min="5" max="25">
      </div>
      <div class="field">
        <label data-i18n="startY">上からの開始位置(%)</label>
        <input id="startY" type="number" value="22" min="10" max="40">
      </div>
    </div>

    <div class="inline">
      <div class="color-picker-group">
        <div class="field">
          <label data-i18n="textColor">テキスト色</label>
          <input id="textColor" type="color" value="#fdf5e6">
        </div>
        <div class="field">
          <label data-i18n="highlightColor">強調色</label>
          <input id="highlightColor" type="color" value="#D8AE5C">
        </div>
      </div>
      <div class="field">
        <label data-i18n="shadowBlur">影(ぼかし px)</label>
        <input id="shadowBlur" type="number" value="6" min="0" max="30">
      </div>
    </div>

    <div class="field">
      <label data-i18n="font">フォント</label>
      <select id="fontFamily">
        <option value="serif" data-i18n="fontSerif">明朝体風 (Noto Serif JP)</option>
        <option value="sans" data-i18n="fontSans">ゴシック体風 (Noto Sans JP)</option>
      </select>
    </div>

    <div class="field">
      <label data-i18n="quoteMode">引用符</label>
      <select id="quoteMode">
        <option value="both" data-i18n="quoteBoth">" … " を付ける</option>
        <option value="none" data-i18n="quoteNone">付けない</option>
      </select>
    </div>

    <div class="field">
      <label data-i18n="footerText">フッターテキスト（任意・一番下）</label>
      <input id="footerText" type="text" data-i18n="[placeholder]footerTextPlaceholder" placeholder="中国外交部報道官 2025年11月13日">
      <div class="muted" data-i18n="footerTextDesc">空ならフッター非表示</div>
    </div>

    <div class="field">
      <label data-i18n="footerSize">フッターフォントサイズ(px)</label>
      <input id="footerSize" type="number" value="32" min="18" max="80">
    </div>

    <div style="margin-top:10px;">
      <button class="btn" id="renderBtn" data-i18n="render">再描画</button>
      <button class="btn primary" id="saveBtn" data-i18n="save">JPGとして保存</button>
      <div class="muted" data-i18n="saveDesc">右クリックで保存したほうが早いかも</div>
    </div>
  </aside>

  <main>
    <header>
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <span data-i18n="header">中共プロパガンダ・テキストジェネレーター</span>
        <div style="display: flex; align-items: center; gap: 8px;">
          <button id="settingsToggle" class="settings-toggle-btn" aria-label="設定を開く">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41l-0.36,2.54c-0.59,0.24-1.13,0.56-1.62,0.94l-2.39-0.96c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>
            </svg>
          </button>
          <a href="https://github.com/mixivalo/ccpgen" target="_blank" rel="noopener noreferrer" class="github-link" title="GitHub">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" style="vertical-align: middle;">
              <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
            </svg>
          </a>
        </div>
      </div>
    </header>
    <div class="canvas-wrap">
      <canvas id="cv"></canvas>
    </div>
  </main>
</div>
</body>
</html>
